bitmap("lll.RNP.mmm.jpg",type="jpeg",height=9,width=9,res=600,pointsize=18)
layout(matrix(c(1,1,2,3,4,5), 3, 2, byrow = TRUE), c(1,1), c(0.4,1,1))
temp = c(0,1)
par(xaxs="i")
par(yaxs="i")
par(cex.axis=1.0)

par(mar=c(1,4,1,2))
plot(temp,temp,type="n",ylab="",xlab="",main="",axes=FALSE)
text(0.5,0.7,labels="ttt",cex=1.5,font=2)
text(0.5,0.3,labels="Reads mapping to host mRNAs; (-100,-10;+10,+100) around stop codons",cex=1.2,font=2)

fwd_cds = read.table("lll.RNP.mmm.fwd.cds")
fwd_utr = read.table("lll.RNP.mmm.fwd.utr")
rev_cds = read.table("lll.RNP.mmm.rev.cds")
rev_utr = read.table("lll.RNP.mmm.rev.utr")
maxcts = max(fwd_cds$V2,fwd_utr$V2,rev_cds$V2,rev_utr$V2)
ymax1 = max(fwd_cds$V2/max(1,sum(fwd_cds$V2)),fwd_utr$V2/max(1,sum(fwd_utr$V2)))
ymax2 = max(rev_cds$V2/max(1,sum(rev_cds$V2)),rev_utr$V2/max(1,sum(rev_utr$V2)))

par(mar=c(4,4,1,2))

plot(temp,temp,type="n",ylab="counts",xlab="read length (nt)",main="",xlim=c(25,50),ylim=c(0,maxcts))
lines(fwd_cds$V1,fwd_cds$V2,col="red")
lines(fwd_utr$V1,fwd_utr$V2,col=colors()[53])
lines(c(48,49.5),c(1,1)*maxcts*0.95,col="red")
lines(c(48,49.5),c(1,1)*maxcts*0.85,col=colors()[53])
text(47.7,maxcts*0.95,labels="CDS fwd",adj=1.0,cex=1)
text(47.7,maxcts*0.85,labels="3'UTR fwd",adj=1.0,cex=1)

plot(temp,temp,type="n",ylab="normalized counts",xlab="read length (nt)",main="",xlim=c(25,50),ylim=c(0,ymax1))
lines(fwd_cds$V1,fwd_cds$V2/max(1,sum(fwd_cds$V2)),col="red")
lines(fwd_utr$V1,fwd_utr$V2/max(1,sum(fwd_utr$V2)),col=colors()[53])
lines(c(48,49.5),c(1,1)*ymax1*0.95,col="red")
lines(c(48,49.5),c(1,1)*ymax1*0.85,col=colors()[53])
text(47.7,ymax1*0.95,labels="CDS fwd",adj=1.0,cex=1)
text(47.7,ymax1*0.85,labels="3'UTR fwd",adj=1.0,cex=1)

plot(temp,temp,type="n",ylab="counts",xlab="read length (nt)",main="",xlim=c(25,50),ylim=c(0,maxcts))
lines(rev_cds$V1,rev_cds$V2,col="blue")
lines(rev_utr$V1,rev_utr$V2,col=colors()[121])
lines(c(48,49.5),c(1,1)*maxcts*0.95,col="blue")
lines(c(48,49.5),c(1,1)*maxcts*0.85,col=colors()[121])
text(47.7,maxcts*0.95,labels="CDS rev",adj=1.0,cex=1)
text(47.7,maxcts*0.85,labels="3'UTR rev",adj=1.0,cex=1)

plot(temp,temp,type="n",ylab="normalized counts",xlab="read length (nt)",main="",xlim=c(25,50),ylim=c(0,ymax2))
lines(rev_cds$V1,rev_cds$V2/max(1,sum(rev_cds$V2)),col="blue")
lines(rev_utr$V1,rev_utr$V2/max(1,sum(rev_utr$V2)),col=colors()[121])
lines(c(48,49.5),c(1,1)*ymax2*0.95,col="blue")
lines(c(48,49.5),c(1,1)*ymax2*0.85,col=colors()[121])
text(47.7,ymax2*0.95,labels="CDS rev",adj=1.0,cex=1)
text(47.7,ymax2*0.85,labels="3'UTR rev",adj=1.0,cex=1)

dev.off()
